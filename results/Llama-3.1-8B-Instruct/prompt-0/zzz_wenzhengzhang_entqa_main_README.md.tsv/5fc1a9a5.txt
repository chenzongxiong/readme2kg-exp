The <SOFTWARE>python</SOFTWARE> preprocess_data.py \ --raw_dir /raw_aida/  --out_aida_dir /retriever_input/  \ --raw_kb_path /raw_kb/[kilt wikipedia file name] --out_kb_path /kb/entities_kilt.json \ --max_ent_len 128  --instance_length 32 --stride 16 --pos_prop 1 --title_map_dir /raw_aida/  script is used for preprocessing AIDA data and KILT kb.

The <SOFTWARE>python</SOFTWARE> run_retriever.py \ --model /model_retriever/retriever.pt  --data_dir /retriever_input/   --kb_dir /kb/ \ --k 100 --num_cands 64  --pretrained_path /blink/BLINK/models/ --gpus 0,1,2,3  --max_len 42   \ --mention_bsz 4096 --entity_bsz 2048  --epochs 4  --B 4  --lr 2e-6  --rands_ratio 0.9   \ --logging_step 100 --warmup_proportion 0.2  --out_dir /reader_input/    --gradient_accumulation_steps 2  --type_loss sum_log_nce   \ --cands_embeds_path /candidates_embeds/candidate_embeds.npy \ --blink  --add_topic script is used for training retriever.

It takes 10 hours on 4 <SOFTWARE>A100 GPUs</SOFTWARE> to finish the retriever training experiments.